From 4b85f8c91f3edf404693507a2bef5d192a3eda85 Mon Sep 17 00:00:00 2001
From: amitbadala <amitbadala07@gmail.com>
Date: Fri, 21 Jun 2019 13:42:43 +0530
Subject: [PATCH] issue details ui fixes

---
 client/src/components/Board/BoardBox.js       |  22 ++-
 .../IssueDetailsModal/IssueDetails.css        |   6 +
 .../IssueDetailsModal/IssueDetails.js         | 150 ++++++++++++------
 .../components/LabelsComponent/AddLabels.js   |  60 +++----
 client/src/components/Navbar/Navbar.js        |   4 +
 client/src/index.css                          |  22 +++
 6 files changed, 182 insertions(+), 82 deletions(-)

diff --git a/client/src/components/Board/BoardBox.js b/client/src/components/Board/BoardBox.js
index ca39d43..929b1b0 100644
--- a/client/src/components/Board/BoardBox.js
+++ b/client/src/components/Board/BoardBox.js
@@ -5,7 +5,7 @@ import './BoardBox.css';
 
 class BoardBox extends React.Component {
   state = {
-    disableClick: false,
+    disableClick: false
   };
 
   handleClick = e => {
@@ -18,7 +18,7 @@ class BoardBox extends React.Component {
   toggleClickHandle = e => {
     e.preventDefault();
     this.setState({
-      disableClick: !this.state.disableClick,
+      disableClick: !this.state.disableClick
     });
   };
 
@@ -26,18 +26,30 @@ class BoardBox extends React.Component {
     const { props } = this;
     return (
       <>
-        <Card interactive={true} elevation={Elevation.TWO} className="board-container">
+        <Card
+          interactive={true}
+          elevation={Elevation.TWO}
+          className="board-container"
+        >
           {props.boardRole === 'SUPERADMIN' ? (
             <>
               <EditButtonPopover className="edit-icon" />
-              <span className={'bp3-icon-standard bp3-icon-crown custom-icon'} />
+              <span
+                className={'bp3-icon-standard bp3-icon-crown custom-icon'}
+              />
             </>
           ) : props.boardRole === 'CREATE' ? (
             <span className={'bp3-icon-standard bp3-icon-plus'} />
           ) : (
             <span className={'bp3-icon-standard bp3-icon-user custom-icon'} />
           )}
-          <div onClick={props.addNewBoard ? () => props.addNewBoard() : () => props.openKanban()}>
+          <div
+            onClick={
+              props.addNewBoard
+                ? () => props.addNewBoard()
+                : () => props.openKanban()
+            }
+          >
             <p>{props.boardName}</p>
             <p className={'bp3-text-small bp3-text-muted'}>
               {props.createdBy ? `${props.createdBy}` : null}
diff --git a/client/src/components/IssueDetailsModal/IssueDetails.css b/client/src/components/IssueDetailsModal/IssueDetails.css
index deb4169..92d45f4 100644
--- a/client/src/components/IssueDetailsModal/IssueDetails.css
+++ b/client/src/components/IssueDetailsModal/IssueDetails.css
@@ -23,6 +23,12 @@ body {
 
 .comments {
     padding: 8px;
+    max-height: 300px;
+    overflow: scroll;
+}
+
+.comments p {
+    margin-bottom: 2px;
 }
 
 .issue-header {
diff --git a/client/src/components/IssueDetailsModal/IssueDetails.js b/client/src/components/IssueDetailsModal/IssueDetails.js
index a8ea5d5..bb2669e 100644
--- a/client/src/components/IssueDetailsModal/IssueDetails.js
+++ b/client/src/components/IssueDetailsModal/IssueDetails.js
@@ -9,6 +9,8 @@ import {
   MenuItem,
   InputGroup,
   Card,
+  Intent,
+  Divider
 } from '@blueprintjs/core';
 import './IssueDetails.css';
 import Upvote from '../Upvote/Upvote';
@@ -32,7 +34,7 @@ export class IssueDetails extends React.Component {
     isOpen: true,
     usePortal: true,
     round: true,
-    commentInputText: '',
+    commentInputText: ''
   };
 
   handleOpen = () => {
@@ -50,7 +52,12 @@ export class IssueDetails extends React.Component {
 
   handleAddCommentOnClick = () => {
     const { commentInputText } = this.state;
-    const { showIssueDetails, getDataForKanbanView, currentBoardId, currentUserId } = this.props;
+    const {
+      showIssueDetails,
+      getDataForKanbanView,
+      currentBoardId,
+      currentUserId
+    } = this.props;
     const issueid = this.props.selectedIssue._id;
 
     if (commentInputText === '') {
@@ -61,8 +68,8 @@ export class IssueDetails extends React.Component {
     axios(ADD_COMMENT_URL, {
       method: 'post',
       data: {
-        comment: commentInputText,
-      },
+        comment: commentInputText
+      }
     })
       .then(res => {
         this.setState({ commentInputText: '' });
@@ -81,7 +88,7 @@ export class IssueDetails extends React.Component {
     const deleteIssueURL = `${BASE_URL}/issues/${issueid}`;
     axios(deleteIssueURL, {
       method: 'delete',
-      params: { boardid },
+      params: { boardid }
     })
       .then(res => {
         this.handleClose();
@@ -94,10 +101,15 @@ export class IssueDetails extends React.Component {
   handleDeleteCommentOnClick = comment => {
     const issueid = this.props.selectedIssue._id;
     const commentid = comment._id;
-    const { showIssueDetails, getDataForKanbanView, currentBoardId, currentUserId } = this.props;
+    const {
+      showIssueDetails,
+      getDataForKanbanView,
+      currentBoardId,
+      currentUserId
+    } = this.props;
     const deleteCommentURL = `${BASE_URL}/issues/${issueid}/comment/${commentid}`;
     axios(deleteCommentURL, {
-      method: 'delete',
+      method: 'delete'
     })
       .then(res => {
         successToast('Comment deleted');
@@ -138,7 +150,7 @@ export class IssueDetails extends React.Component {
           issue: 'Loading...',
           upvotes: 0,
           assignee: 'Loading...',
-          upvotedBy: [],
+          upvotedBy: []
         };
     const members = [];
     const userId = this.props.currentUserId;
@@ -147,15 +159,23 @@ export class IssueDetails extends React.Component {
 
     return (
       <div>
-        <Dialog onClose={this.handleClose} title="Issue Details" {...this.state}>
+        <Dialog
+          onClose={this.handleClose}
+          title="Issue Details"
+          {...this.state}
+        >
           <div className={Classes.DIALOG_BODY}>
             <div className="row">
               <div className="column">
                 <h3 className="issue-header">{issue.issue}</h3>
               </div>
-              <div className="column">
-                <Upvote upvotes={issue.upvotes} issueid={issue._id} upvoted={upvotedState} />
-              </div>
+              {/* <div className="column">
+                <Upvote
+                  upvotes={issue.upvotes}
+                  issueid={issue._id}
+                  upvoted={upvotedState}
+                />
+              </div> */}
             </div>
             <div className="label">
               <ViewLabels />
@@ -185,41 +205,76 @@ export class IssueDetails extends React.Component {
             <div className="comments">
               {issue.comments
                 ? issue.comments.map(comment => (
-                    <Card key={comment._id}>
-                      <p>{comment.comment}</p>
-                      <p>
-                        {comment.commentedBy ? comment.commentedBy.name : null}{' '}
-                        {this.getTimeDifference(comment.createdAt)}
-                      </p>
-                      <Popover commentid={comment._id}>
-                        <Button intent="danger" text="Delete Comment" />
-                        <DeleteConfirmation
-                          onSuccess={() => this.handleDeleteCommentOnClick(comment)}
-                          item="comment"
-                        />
-                      </Popover>
-                    </Card>
+                    <>
+                      <Card key={comment._id} className="plain-card">
+                        <p>
+                          <span
+                            className="theme-color"
+                            style={{ fontWeight: '600' }}
+                          >
+                            {comment.commentedBy
+                              ? comment.commentedBy.name
+                              : null}
+                          </span>
+                          {' : '}
+                          {comment.comment}
+                          {/* {this.getTimeDifference(comment.createdAt)} */}
+                        </p>
+                        <div
+                          className="row"
+                          style={{ justifyContent: 'space-between' }}
+                        >
+                          <div style={{ padding: '5px' }}>
+                            <Popover commentid={comment._id}>
+                              <Button
+                                intent={Intent.NONE}
+                                minimal="true"
+                                icon="trash"
+                              />
+                              <DeleteConfirmation
+                                onSuccess={() =>
+                                  this.handleDeleteCommentOnClick(comment)
+                                }
+                                item="comment"
+                              />
+                            </Popover>
+                          </div>
+                          <div>
+                            <p className="date-stamp">
+                              {this.getTimeDifference(comment.createdAt)}
+                            </p>
+                          </div>
+                        </div>
+                      </Card>
+                      <Divider className="white-thick-divider" />
+                    </>
                   ))
                 : null}
-
-              <form>
-                <div style={{ margin: '4px' }}>
-                  <label>Comment:</label>
-                  <InputGroup
-                    placeholder="Add your comment"
-                    value={commentInputText}
-                    onChange={event => this.handleCommentInputChange(event)}
-                  />
-                </div>
-              </form>
-              <Button intent="success" onClick={() => this.handleAddCommentOnClick()}>
-                Add Comment
-              </Button>
             </div>
-            <Comment />
+
+            <form>
+              <div style={{ margin: '4px' }}>
+                <label>Comment:</label>
+                <InputGroup
+                  placeholder="Add your comment"
+                  value={commentInputText}
+                  onChange={event => this.handleCommentInputChange(event)}
+                />
+              </div>
+            </form>
+            <Button
+              intent="success"
+              onClick={() => this.handleAddCommentOnClick()}
+            >
+              Add Comment
+            </Button>
+            {/* <Comment /> */}
             <Popover>
-              <Button intent="danger" text="Delete Issue" />
-              <DeleteConfirmation onSuccess={this.handleDeleteIssue} item="issue" />
+              <Button text="Delete Issue" />
+              <DeleteConfirmation
+                onSuccess={this.handleDeleteIssue}
+                item="issue"
+              />
             </Popover>
           </div>
         </Dialog>
@@ -232,20 +287,21 @@ const mapStateToProps = state => {
   return {
     selectedIssue: state.selectedIssue,
     currentUserId: state.currentUserId,
-    currentBoardId: state.currentBoardId,
+    currentBoardId: state.currentBoardId
   };
 };
 
 const mapDispatchToProps = dispatch => {
   return {
     closeModal: () => dispatch(actionCreators.closeIssueDetailsModal()),
-    showIssueDetails: issueid => dispatch(actionCreators.showIssueDetails(issueid)),
+    showIssueDetails: issueid =>
+      dispatch(actionCreators.showIssueDetails(issueid)),
     getDataForKanbanView: (boardid, userid) =>
-      dispatch(actionCreators.getDataForKanbanView(boardid, userid)),
+      dispatch(actionCreators.getDataForKanbanView(boardid, userid))
   };
 };
 
 export default connect(
   mapStateToProps,
-  mapDispatchToProps,
+  mapDispatchToProps
 )(IssueDetails);
diff --git a/client/src/components/LabelsComponent/AddLabels.js b/client/src/components/LabelsComponent/AddLabels.js
index f227119..0c8901d 100644
--- a/client/src/components/LabelsComponent/AddLabels.js
+++ b/client/src/components/LabelsComponent/AddLabels.js
@@ -42,39 +42,39 @@ class AddLabels extends React.Component {
 
   render() {
     return (
-      <Popover
-        content={
-          <Menu className={Classes.ELEVATION_ONE} style={{ display: 'block' }}>
-            <div className="add-name">
-              <label>
-                Name:
-                <InputGroup
-                  type="text"
-                  value={this.state.name}
-                  onChange={this.handleNameChange}
-                />
-              </label>
-            </div>
-            <div className="add-color">
-              <label>
-                Color:
-                <div style={{ margin: '14px' }}>
-                  <TwitterPicker
+      <>
+        <Popover
+          content={
+            <Menu className={Classes.ELEVATION_ONE}>
+              <div className="add-name">
+                <label>
+                  Name:
+                  <input
+                    type="text"
+                    value={this.state.name}
+                    onChange={this.handleNameChange}
+                  />
+                </label>
+              </div>
+              <div className="add-color">
+                <label>
+                  Color:
+                  <BlockPicker
                     color={this.state.color}
                     onChangeComplete={this.handleColorChange}
                   />
-                </div>
-              </label>
-            </div>
-            <div className={Classes.POPOVER_DISMISS}>
-              <button onClick={this.handleSubmit}>Add new Label</button>
-            </div>
-          </Menu>
-        }
-        position={Position.BOTTOM_LEFT}
-      >
-        <Button rightIcon="arrow-down" text="Add Labels" />
-      </Popover>
+                </label>
+              </div>
+              <div className={Classes.POPOVER_DISMISS}>
+                <button onClick={this.handleSubmit}>Add new Label</button>
+              </div>
+            </Menu>
+          }
+          position={Position.BOTTOM_LEFT}
+        >
+          <Button rightIcon="arrow-down" text="Add Labels" />
+        </Popover>
+      </>
     );
   }
 }
diff --git a/client/src/components/Navbar/Navbar.js b/client/src/components/Navbar/Navbar.js
index 28a67ff..ab09a0b 100644
--- a/client/src/components/Navbar/Navbar.js
+++ b/client/src/components/Navbar/Navbar.js
@@ -13,6 +13,8 @@ import {
 } from '@blueprintjs/core';
 import { LogoutUrl } from '../../config';
 import * as actionCreators from '../../actions/actionDispatchers';
+import AddLabels from '../LabelsComponent/AddLabels';
+import ViewLabels from '../LabelsComponent/ViewLabels';
 
 const mapStateToProps = state => {
   const {
@@ -85,6 +87,8 @@ export class Navbar extends React.Component {
                 text="Member list"
                 onClick={this.props.toggleMemberListModal}
               />
+              <ViewLabels />
+              <AddLabels />
             </>
           ) : null}
         </div>
diff --git a/client/src/index.css b/client/src/index.css
index 10deb8e..9f1435d 100644
--- a/client/src/index.css
+++ b/client/src/index.css
@@ -29,3 +29,25 @@ code {
 .container-layout {
   padding: 30px;
 }
+
+.theme-color{
+  color:cornflowerblue;
+}
+
+.plain-card{
+  padding: 5px;  
+  box-shadow: none;
+}
+
+.white-thick-divider{
+  margin: 5px;
+    border-right: 2px solid rgb(255, 255, 255);
+    border-bottom: 2px solid rgb(255, 255, 255);
+}
+
+.date-stamp {
+  color:grey;
+  font-size:12px;
+}
+
+ 
\ No newline at end of file
-- 
2.17.1

